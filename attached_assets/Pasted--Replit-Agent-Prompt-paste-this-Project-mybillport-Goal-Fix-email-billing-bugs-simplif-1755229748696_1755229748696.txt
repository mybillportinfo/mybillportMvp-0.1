
‚∏ª

üü¶ Replit Agent Prompt (paste this)

Project: mybillport
Goal: Fix email + billing bugs, simplify bill creation, add reminders, and run a full config audit.

0) Preconditions
	‚Ä¢	Use the existing Firebase project/secrets.
	‚Ä¢	Use TypeScript if present; otherwise plain JS is fine.
	‚Ä¢	Keep current UI theme/branding.

‚∏ª

1) Fix: ‚ÄúRequest Money / Send Email‚Äù not working
	‚Ä¢	Implement email sending via MailerSend (preferred) or SendGrid:
	‚Ä¢	Read API key from secrets: MAILERSEND_API_KEY (or SENDGRID_API_KEY).
	‚Ä¢	Create a reusable services/email.ts (or .js) with:
	‚Ä¢	sendPaymentRequestEmail({to,name,amount,note})
	‚Ä¢	sendBillCreatedEmail({to,billName,amount,dueDate})
	‚Ä¢	On success/failure, surface toast notifications in the UI.
	‚Ä¢	Add a simple test route /email-test that sends a sample email to TEST_EMAIL secret and shows the HTTP response code/body.

Acceptance: Clicking ‚ÄúRequest Money‚Äù sends an email; /email-test returns 2xx and the UI shows ‚ÄúEmail sent‚Äù.

‚∏ª

2) Fix: ‚ÄúAdd Bill (e.g., Rogers)‚Äù saves but does not appear on dashboard
	‚Ä¢	Trace current create flow in services/bills* and the dashboard fetch hook/component.
	‚Ä¢	Ensure new bills are written to Firestore and read in the dashboard query:
	‚Ä¢	Collection: bills
	‚Ä¢	Required fields: name, accountNumber, amount, dueDate, frequency, leadDays, paid=false, createdAt=serverTimestamp(), userId=auth.uid
	‚Ä¢	If using client cache/state, invalidate/refetch after addBill(...) resolves.
	‚Ä¢	Add Firestore security rules so users can only read/write their own bills:
	‚Ä¢	/bills/{id} readable/writable only when request.auth.uid == resource.data.userId || request.auth.uid == request.resource.data.userId.

Acceptance: Creating ‚ÄúRogers‚Äù shows immediately on the dashboard without refresh, and appears after hard reload.

‚∏ª

3) Simplify ‚ÄúAdd Bill‚Äù form (3 required + 2 optional)

Replace the current questionnaire with the minimal fields:

Required
	1.	Account Number (accountNumber: string)
	2.	Monthly Amount (amount: number, currency CAD by default)
	3.	Due Date (dueDate: ISO date or day-of-month 1‚Äì31; store normalized date)

Optional
4. Reminder Lead Time (leadDays: enum {1,3,7} ‚Äì default 3)
5. Frequency (frequency: enum {monthly, biweekly, weekly} ‚Äì default monthly)
	‚Ä¢	Keep a Bill Name auto-filled from a short dropdown of common providers (Rogers, Bell, Telus, Hydro One, Enbridge, Netflix, Spotify, Amazon Prime) with free‚Äëtext fallback. Store in name.
	‚Ä¢	Validate: positive amount, account number non-empty, due date valid day; show inline errors.

Acceptance: The new Add Bill modal has only these fields and creates a bill with correct schema.

‚∏ª

4) Dashboard ordering & sections
	‚Ä¢	Sort unpaid bills by soonest due date (ascending).
	‚Ä¢	Sections:
	‚Ä¢	Overdue
	‚Ä¢	Due Soon (‚â§7 days)
	‚Ä¢	All Others
	‚Ä¢	‚ÄúRogers‚Äù or any newly added bill must appear in the correct section immediately.

Acceptance: Sorting stable across reloads; new bill placed in the correct section.

‚∏ª

5) Reminder engine (client + server)
	‚Ä¢	Add a Cloud Function (or a Replit cron if no functions) that runs daily (UTC 06:00) to:
	‚Ä¢	Find bills where paid=false and dueDate - today == leadDays
	‚Ä¢	Send reminder email via sendBillReminderEmail({to, name, amount, dueDate})
	‚Ä¢	Log result to notifications collection.
	‚Ä¢	Provide a manual test button ‚ÄúSend Reminder Now‚Äù on /firebase-test to trigger the job for the current user.

Acceptance: When leadDays matches, an email is sent and a notifications entry is created.

‚∏ª

6) UX polish
	‚Ä¢	After bill created: show success toast ‚ÄúBill added‚Äù and auto-close modal.
	‚Ä¢	On failure: show readable error; log error to console with stack.
	‚Ä¢	Add skeleton loaders / empty states: ‚ÄúNo bills yet ‚Äî add your first bill‚Äù.

‚∏ª

7) Config & Secrets audit (report + self-check)

Create a script scripts/configAudit.ts that checks and prints ‚úÖ/‚ùå for these:

Firebase
	‚Ä¢	VITE_FIREBASE_API_KEY, VITE_FIREBASE_APP_ID, VITE_FIREBASE_PROJECT_ID
	‚Ä¢	Firestore & Auth initialized
	‚Ä¢	Rules deployed date (if available)

Mailer
	‚Ä¢	MAILERSEND_API_KEY or SENDGRID_API_KEY
	‚Ä¢	FROM_EMAIL and FROM_NAME

Domain
	‚Ä¢	A record points to 34.111.179.208
	‚Ä¢	TXT replit-verify=... present
	‚Ä¢	www CNAME ‚Üí apex

Plaid (optional if present)
	‚Ä¢	PLAID_CLIENT_ID, PLAID_SECRET, PLAID_ENV

Emit a human-readable report to console and /admin/config-report route.

Acceptance: Running npm run config:audit prints a checklist and the admin route renders the same.

Add npm script: